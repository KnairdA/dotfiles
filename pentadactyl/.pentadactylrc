loadplugins '\.(js|penta)$'
group user

set guioptions=Cs
set hintkeys=0123456789

map -b j 5j
map -b k 5k

hi clear

hi s_greenfont     color:#aadb0f;
hi s_palegreenfont color:#909737;
hi s_grayback      background:#161616;
hi s_normal        font-size:16px; font-family:Fantasque Sans Mono;

hi -link=s_normal,s_grayback,s_palegreenfont Normal                                   border-top:1px solid #909737;
hi -link=s_normal,s_grayback,s_palegreenfont StatusLine
hi -link=s_normal,s_grayback,s_palegreenfont StatusLineNormal
hi -link=s_normal,s_grayback,s_palegreenfont StatusLineBroken
hi -link=s_normal,s_grayback,s_palegreenfont StatusLineExtended
hi -link=s_normal,s_grayback,s_palegreenfont StatusLineSecure
hi -link=s_normal,s_grayback,s_palegreenfont CompTitle
hi                                           CompTitleSep                             background:#909737;height:1px;
hi                                           Comp                                     border:0;margin:0;
hi -link=s_normal,s_grayback,s_palegreenfont CompItem
hi -link=s_normal,s_grayback,s_palegreenfont CompItem[selected]                       background:#909737;color:#161616;
hi -link=s_normal,s_palegreenfont            CompItem:nth-child(2n+1)                 background:#121212;
hi -link=s_normal,s_grayback,s_palegreenfont CompItem:nth-child(2n+1)[selected]       background:#909737;color:#161616;

hi -link=s_normal,s_greenfont,s_grayback     Hint                                     font-weight:bold; padding:2px;
hi                                           HintElem                                 background:#a5a5a5;
hi                                           Hint[active]                             background:#aadb0f;color:#161616;
hi                                           HintActive                               background:#aadb0f;

command! reader -js <<EOF
if ( buffer.URL.spec.startsWith('about:reader?') ) {
	dactyl.execute('back')
} else {
	dactyl.open('about:reader?url=' + encodeURIComponent(buffer.URL.spec))
}
EOF

command! push2inbox -js <<EOF
var selection = content.getSelection().toString();
var entry     = '\* ' + buffer.URL;

if ( selection ) {
	entry += '\\n\\t\* ' + selection;
} else if ( content.document.title ) {
	entry += '\\n\\t\* ' + content.document.title;
}

dactyl.execute('!echo -e "' + entry + '" >> ~/note/src/web/inbox.wiki');
EOF
command! cite -js <<EOF
var entry = '\\n'
          + '    [...] ' + content.getSelection().toString().replace('\n', '\n    ') + ' [...]\\n'
          + '    <br/>\<br/>\\n'
          + '     â€• ' + buffer.URL
          + '\\n';

dactyl.execute('!echo -e "' + entry.replace('"', '\"') + '" >> ~/note/src/web/inbox.wiki');
EOF

map -builtin -ex <F9>  :reader
map -builtin -ex <F10> :emenu ScrapBook X.Show in Sidebar

nmap b :emenu ScrapBook X.Save Page<CR>
nmap c :cite<CR>
